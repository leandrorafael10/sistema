<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="./../principal/templategreen.xhtml">

        <ui:define name="principal-interna">

            <br/>

            <h:form id="formFuncionario">

                <p:growl showDetail="true"  life="7000" id="growlmsg"/>
                <p:panel >
                    <h2>Cadastro de Funcionário</h2>
                    <p:separator/>

                    <h:panelGrid columns="6"  cellpadding="5"  title="Cadastro funcionário">

                        <h:outputLabel value="Nome"/>
                        <p:inputText value="#{funcionarioBean.funcionario.IDPessoa.razao}" 
                                     requiredMessage="Nome e obrigatorio!"
                                     required="true"
                                     size="30"
                                     maxlength="50"/>
                        <h:outputLabel  value="Data Nascimento:"/>
                        <p:calendar value="#{funcionarioBean.funcionario.IDPessoa.DTNascimento}"
                                    showButtonPanel="true" 
                                    navigator="true" 
                                    size="10"
                                    mask="true"
                                    pattern="dd/MM/yyyy"
                                    locale="pt"
                                    yearRange="c-80:"
                                    />
                        <h:outputText value="Sexo:"/>
                        <h:selectOneRadio value="#{funcionarioBean.funcionario.sexo}" required="true" requiredMessage="Informação de sexo é obrigatoria!">
                            <f:selectItem itemLabel="Masculino" itemValue="M"/>
                            <f:selectItem itemLabel="Feminino" itemValue="F"/>
                        </h:selectOneRadio>
                        <h:outputText value="Mãe"/>
                        <p:inputText value="#{funcionarioBean.funcionario.filiacaoM}" maxlength="40"/>
                        <h:outputText value="Pai:"/>
                        <p:inputText value="#{funcionarioBean.funcionario.filiacaoP}" maxlength="40"/>
                        <h:outputLabel  value="Naturalidade:"/>
                        <p:inputText value="#{funcionarioBean.funcionario.IDPessoa.naturalidade}"
                                     size="10" 
                                     maxlength="40"/>
                        <h:outputLabel value="Telefone fixo:"/>
                        <p:inputMask mask="(99)9999-9999" label="Tel fixo" value="#{funcionarioBean.telefoneF}"
                                     size="13"
                                     required="true"
                                     requiredMessage="Pelo menos um telefone e obrigatorio!"
                                     />
                        <h:outputText value="Telefone celular:"/>
                        <p:inputMask mask="(99)9999-9999" value="#{funcionarioBean.telefoneCel}"
                                     size="13"
                                     label="Tel cel"/>

                        <h:outputText value="E-MAIL:"/>
                        <p:inputText id="email_fum" label="E-MAIL" value="#{funcionarioBean.funcionario.IDPessoa.email}"
                                     size="30"
                                     validatorMessage="Email com formato errado!"
                                     maxlength="50"
                                     >
                        </p:inputText>

                        <h:outputLabel value="CPF:*"/>
                        <p:inputMask mask="999.999.999-99" value="#{funcionarioBean.funcionario.IDPessoa.cnpjCpf}"
                                     required="true"
                                     size="13"
                                     maxlength="11"
                                     requiredMessage="CPF é obrigatório"/>
                        <h:outputLabel value="RG"/>
                        <p:inputText value="#{funcionarioBean.funcionario.IDPessoa.rg}"
                                     size="10"
                                     maxlength="20"/>

                        <h:outputText value="Nº CTPS:"/>

                        <p:inputText value="#{funcionarioBean.funcionario.ctrabalho}"
                                     size="12"
                                     maxlength="12"
                                     required="true"
                                     requiredMessage="CTPS é obrigatório!" />
                        <h:outputText value="Serie:"/>
                        <p:inputText value="#{funcionarioBean.funcionario.serieCtps}" maxlength="10" size="8"/>
                        <h:outputText value="Data admissão:"/>
                        <p:calendar value="#{funcionarioBean.funcionario.DTAdmissao}"
                                    navigator="true"
                                    showButtonPanel="true" size="10"
                                    pattern="dd/MM/yyyy"
                                    mask="true"
                                    locale="pt"
                                    yearRange="c-80:"
                                    required="true"
                                    requiredMessage="Data obrigatória!"/>

                        <h:outputText value="Nº CNH:"/>
                        <p:inputMask mask="99999999999" 
                                     value="#{funcionarioBean.funcionario.cnh}" requiredMessage="Numero invalido!"
                                     size="11"/>

                        <h:outputText value="Categoria (CNH):"/>
                        <p:inputText value="#{funcionarioBean.funcionario.cnhCategoria}"
                                     size="2"
                                     maxlength="2"/>

                        <h:outputText value="Data validade CNH:"/>
                        <p:calendar  value="#{funcionarioBean.funcionario.dtValidadeCNH}"
                                     showButtonPanel="true" size="10"
                                     pattern="dd/MM/yyyy"
                                     locale="pt"/>

                        <h:outputText value="Nº Pis:"/>
                        <p:inputMask mask="999999999-99" value="#{funcionarioBean.funcionario.pisPasep}"
                                     validatorMessage="Numero inválido pis!"
                                     size="12"/>
                        <h:outputLabel  value="Cep:"/>
                        <p:inputMask  mask="99999-999"  value="#{funcionarioBean.funcionario.IDPessoa.cep}"  size="10"
                                      >
                            <p:ajax  event="blur" listener="#{funcionarioBean.buscaPorCep()}"
                                     update="inputLogradouro,inputBairro,inputCidade,inputUF" 
                                     />

                        </p:inputMask>
                        <h:outputLabel  value="Rua/Avenida:"/>
                        <p:inputText id="inputLogradouro"  value="#{funcionarioBean.funcionario.IDPessoa.logradouro}"
                                     size="40"
                                     maxlength="40"
                                     required="true"
                                     requiredMessage="Campo Obrigatório!">
                        </p:inputText>
                        <h:outputLabel  value="Nº:"/>
                        <p:inputText  value="#{funcionarioBean.funcionario.IDPessoa.numero}"
                                      size="8"
                                      maxlength="20"
                                      />

                        <h:outputLabel  value="Bairro:"/>
                        <p:inputText id="inputBairro" value="#{funcionarioBean.funcionario.IDPessoa.bairro}"
                                     size="30"
                                     maxlength="30"
                                     >
                        </p:inputText>
                        <h:outputText value="Cidade:"/>
                        <p:inputText id="inputCidade" value="#{funcionarioBean.funcionario.IDPessoa.cidade}"/>
                        <h:outputText value="UF:"/>
                        <p:inputText id="inputUF"  value="#{funcionarioBean.funcionario.IDPessoa.estado}" maxlength="2" size="4" />
                        
                        <h:outputText value="Pais"/>
                        <p:selectOneMenu value="#{funcionarioBean.funcionario.IDPessoa.pais}">
                            <f:selectItem itemValue="Brasil" itemLabel="Brasil"/>
                            <f:selectItem itemValue="Argentina" itemLabel="Argentina"/>
                            <f:selectItem itemValue="Paraguai" itemLabel="Paraguai"/>
                            <f:selectItem itemValue="Uruguai" itemLabel="Uruguai"/>
                        </p:selectOneMenu>
                        <h:outputText value="Função:"/>
                        <p:selectOneMenu converter="funcaoConverter" filter="true" value="#{funcionarioBean.funcionario.IDFuncao}">  
                            <f:selectItems value="#{funcaoRN.listar()}"
                                           var="funcao"
                                           itemLabel="#{funcao.descricao}"
                                           itemValue="#{funcao}"/>  
                        </p:selectOneMenu>
                        <h:outputText value="Empresa:"/>
                        <p:selectOneMenu converter="filialConverter" filter="true" value="#{funcionarioBean.funcionario.IDFilial}" required="true"
                                         requiredMessage="Informe a empresa de registro.">
                            <f:selectItem itemLabel="" />
                            <f:selectItems value="#{filialRN.listar()}"
                                           var="filial"
                                           itemValue="#{filial}"
                                           itemLabel="#{filial.fantasia}"/>
                        </p:selectOneMenu>

                    </h:panelGrid>

                    <p:separator/>
                    <p:commandButton value="Confirmar" actionListener="#{funcionarioBean.salvarFuncionario}"  update=":formFuncionario" />
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <p:commandButton type="reset" value="Limpar"/>
                </p:panel>

               
            </h:form>
            <h:form id="formCapturaFoto">
                <p:dialog widgetVar="dialogCapturaFoto">
                    <h:panelGrid columns="4" id="gridFoto">
                        <p:photoCam widgetVar="pc" listener="#{funcionarioBean.oncapture}" update="gridFoto"/>
                        <p:commandButton type="button" value="capturar foto" onclick="PF('pc').capture();"/>
                        <h:graphicImage library="imagens" name="#{funcionarioBean.foto}.png" rendered="#{funcionarioBean.foto==''?false:true}"/>
                        <p:commandButton value="cancelar" actionListener="#{funcionarioBean.cancelarFoto(event)}" update="gridFoto" rendered="#{funcionarioBean.foto==''?false:true}"/>
                    </h:panelGrid>
                    <p:separator/>
                    <p:commandButton value="salvar" actionListener="#{funcionarioBean.salvaFoto(event)}" oncomplete="PF('dialogCapturaFoto').hide();"/>
                    <p:commandButton value="sair" actionListener="#{funcionarioBean.cancelarFotoPesquisa(event)}" oncomplete="PF('dialogCapturaFoto').hide();"/>
                </p:dialog>
            </h:form>



            <h:form>
                <p:dialog widgetVar="dialogError" header="Error!" modal="true"
                          draggable="false" closable="false" resizable="false">
                    Cpf já cadastrado!
                    <br/>
                    <p:commandButton value="sair" oncomplete="PF('dialogError').hide();" />


                </p:dialog>
            </h:form>
        </ui:define>
    </ui:composition> 
</html>
